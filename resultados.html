<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Grande Irmão - Resultados</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.3/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 p-6 min-h-screen">

<div class="max-w-6xl mx-auto">

  <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">Grande Irmão - Resultados</h1>

  <!-- FILTRO POR SEMANA -->
  <div class="bg-white p-6 rounded-2xl shadow mb-6 flex flex-col md:flex-row items-center gap-4">
    <label class="font-medium">Semana:</label>
    <input type="number" id="semanaFiltro" class="border rounded-xl px-4 py-2 w-full md:w-32 focus:outline-none focus:ring-2 focus:ring-blue-500">
    <button id="btnFiltrar" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-xl transition">Filtrar</button>
  </div>

  <!-- TABELA DE RESULTADOS -->
  <div id="tabelaResultados" class="overflow-x-auto">
    <table class="min-w-full bg-white rounded-2xl shadow-lg">
      <thead class="bg-gray-200">
        <tr>
          <th class="py-2 px-4 text-left">Semana</th>
          <th class="py-2 px-4 text-left">Líder</th>
          <th class="py-2 px-4 text-left">Anjo</th>
          <th class="py-2 px-4 text-left">Emparedados</th>
          <th class="py-2 px-4 text-left">Eliminados</th>
          <th class="py-2 px-4 text-left">Bate-Volta</th>
        </tr>
      </thead>
      <tbody id="corpoTabela"></tbody>
    </table>
  </div>

</div>

<script>
const supabaseUrl = "https://biojnilbgzozmynemtra.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpb2puaWxiZ3pvem15bmVtdHJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NDM5MzEsImV4cCI6MjA3MjIxOTkzMX0.F8MyL33SdQ7RViOF5RWgoZh8vC6hsyNqmqUXmRcNPDM";
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

// CARREGAR RESULTADOS
async function carregarResultados(semana = null) {
  let query = supabase.from("resultados").select("*").order("semana", { ascending: true });
  if(semana) query = query.eq("semana", semana);

  const { data, error } = await query;
  if(error){ alert("Erro ao carregar resultados: " + error.message); return; }

  const tbody = document.getElementById("corpoTabela");
  tbody.innerHTML = "";

  data.forEach(r => {
    const tr = document.createElement("tr");
    tr.className = "border-b hover:bg-gray-50 transition";

    const td = (v) => `<td class="py-2 px-4 align-top">${Array.isArray(v) ? v.join(", ") : v || ""}</td>`;

    tr.innerHTML = `
      ${td(r.semana)}
      ${td(r.lider)}
      ${td(r.anjo)}
      ${td(r.emparedados)}
      ${td(r.eliminados)}
      ${td(r.bate_volta)}
    `;

    tbody.appendChild(tr);
  });
}

// FILTRO POR SEMANA
document.getElementById("btnFiltrar").addEventListener("click", () => {
  const semana = parseInt(document.getElementById("semanaFiltro").value);
  carregarResultados(semana || null);
});

// CARREGA TODOS AO INICIAR
carregarResultados();
</script>
</body>
</html>
